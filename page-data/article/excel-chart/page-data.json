{"componentChunkName":"component---src-templates-article-js","path":"/article/excel-chart","result":{"data":{"strapiArticle":{"strapiId":16,"title":"寫程式自動化匯出excel檔案裡的統計圖表(Chart)為圖檔","description":"SikuiliX或是Spire.XLS來達成自動化匯出Excel Chart","content":"## 需求\n工作上的開發，大量地使用[Apache POI](https://poi.apache.org/)來產生/操作Excel報表。 \n\n然而針對產生或是讀入的excel檔案，想要匯出其內的統計圖表(Chart)，Apache POI並無提供此功能與API可以達成。  \n\n苦尋了一段時間，一直找不到可以用的Library或工具可以完成這項任務。\n\n\n## OCR GUI automation - SikuliX \n所以換個方向思考，或許有甚麼自動化工具可以達成，於是找到了一套基於螢幕OCR辨識來操作GUI自動化的工具- [SikuliX](http://sikulix.com/)。\n\nSikuli提供了一個IDE工具讓你可以撰寫自動化腳本，腳本的組成會是Python語法和許多螢幕截圖圖片，讓你指定當電腦畫面出現你預期的某些畫面時，會對應操作滑鼠或鍵盤來完成自動化。  \n關於Sikuli更多的介紹，請參考下列:  \n- [SikuliX —— 針對圖形介面寫自動化腳本的小幫手](https://igouist.github.io/post/2020/03/sikulix/)\n- [SikuliX Quickstart](http://sikulix.com/quickstart/)\n\n基於分享與日後使用方便，我已經用SikuliX IDE寫好一組腳本用來自動化擷取XLSX裡的Chart，放在GitHub上了，[請參考這....](https://github.com/dolphlei/exportExcelChartToPng_withSikuliX)  \n\n#### [缺點]\n然而使用SikuliX最大的缺點就是，一定要在有螢幕的電腦執行，還有，自動化執行時不能有螢幕保護程式運行。  \n\n這對於我們很多報表程式都是在Server端執行的環境，幾乎是一大阻礙。\n\n\n## Spire.XLS 組件\n好消息是最近透過同事得知有一套library可以達到不安裝Excel，純粹的使用Java/.NET的API呼叫就可以將 XLS/XLSX裡面的Chart匯出成圖片，這套Library叫做Spire.XLS，是由中國成都冰藍科技開發的。\n\n他有分商業版和免費版，然而將Chart匯出圖片的功能在免費版就有提供了。\n\n實際用了確實也是可行的，真是可喜可賀。\n\n\n#### [缺點]\n然而Spire.XLS也不是萬能的，我手邊有些比較複雜的XLSM Excel報表，其內的Chart是透過開啟Excel文件時啟動VBA巨集(Macro)做了些複雜運算後才動態生成Chart物件的，\n像是這種直接或間接透過巨集執行來動態產生Chart物件或是設定Chart資料來源範圍的檔案，Spire.XLS也是兩手一攤，畢竟這一定要有Excel環境來運行VBA Macro才能得到最後的Chart，這頂多只能回頭看使用SikuiliX能不能達成自動化了。\n\n","content_images":null,"publishedAt":"2021-04-23T11:30:00.000Z","tags":[{"tagName":"Ms Office","slug":"ms-office"},{"tagName":"Excel","slug":"excel"}],"image":{"publicURL":"/blog/static/558a6c2d331872465ae6e4d1b31e05b7/aec811ff934fbde7f9ea62cee989f3a6.png","childImageSharp":{"fixed":{"src":"/blog/static/558a6c2d331872465ae6e4d1b31e05b7/497c6/aec811ff934fbde7f9ea62cee989f3a6.png"}}},"author":{"name":"豆腐","picture":{"childImageSharp":{"fixed":{"src":"/blog/static/814afda129be66d802b5e2e6878690ab/91664/68ec1329a0c03ec83fd29493e1db9bf2.png"}}}}}},"pageContext":{"slug":"excel-chart"}},"staticQueryHashes":["2031881183","3406376217","557794130"]}